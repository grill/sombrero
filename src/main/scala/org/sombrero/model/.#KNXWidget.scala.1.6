package org.sombrero.model
import _root_.net.liftweb.mapper._
import _root_.net.liftweb.util._

import _root_.net.liftweb.http._
import SHtml._
import _root_.net.liftweb.util._
import Helpers._
import _root_.scala.xml._ 

class KNXWidget extends LongKeyedMapper[KNXWidget] with IdPK{
  def getSingleton = KNXWidget
   
  object groupAddress extends MappedString(this, 15) {//???
    def correctAddress(in : String) : List[FieldError] = {
      if("^[0-9][0-9]?/[0-9][0-9]?/[0-9][0-9]?$".r.findPrefixMatchOf(in) == None) {
        List(FieldError(this, Text("incorrect KNX address format")))
      } else {
        List[FieldError]()
      } 
    }
    override def validations = correctAddress _ :: Nil
  }
  object remoteHost extends MappedString(this, 15) {
    def correctAddress(in : String) : List[FieldError] = {
      if("^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$".r.findPrefixMatchOf(in) == None) {
        List(FieldError(this, Text("incorrect IP address format")))
      } else {
        List[FieldError]()
      }
    }
    override def validations = correctAddress _ :: Nil
  }
  object widget extends MappedLongForeignKey(this, Widget) {
    override def dbIndexed_? = true
    override def _toForm = Empty
  }   
}  

object KNXWidget extends KNXWidget with LongKeyedMetaMapper[KNXWidget] {}
