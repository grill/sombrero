
package org.sombrero.model
import net.liftweb.mapper._
import net.liftweb.util._
import _root_.net.liftweb.http.RequestVar

class Room extends LongKeyedMapper[Room] with IdPK {
  def getSingleton = Room
   
  object name extends MappedString(this, 25) {
    override def dbIndexed_? = true
  }
  
  object parent extends MappedLongForeignKey(this, Room) {
    override def dbIndexed_? = true
  } 
  
  def widgets = Widget.findAll(By(Widget.room, this.id))
  def children = Room.findAll(By(Room.parent, this.id))
}  
 
object Room extends Room with LongKeyedMetaMapper[Room] {
  def roots = Room.findAll(By(Room.parent, Empty))
  object currentVar extends RequestVar[Box[Room]](Empty)
  def current = currentVar.is
}
